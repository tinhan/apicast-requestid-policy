{
  "$schema": "http://apicast.io/policy-v1/schema#manifest#",
  "name": "Header modification",
  "summary": "Allows to include custom headers.",
  "description":
    ["This policy allows to include request id in http header"],
  "version": "builtin",
  "configuration": {
    "type": "object",
    "definitions": {
      "commands": {
        "description": "List of operations to apply to the headers",
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "op": {
              "description": "Operation to be applied",
              "type": "string",
              "oneOf": [
                {
                  "enum": ["add"],
                  "title": "Add a value to an existing header."
                }
              ]
            },
            "header": {
              "description": "Header to be modified",
              "type": "string"
            },
            "value": {
              "description": "Value that will be added, add new to header.",
              "type": "string"
            },
            "value_type": {
              "description": "How to evaluate 'value'",
              "type": "string",
              "oneOf": [
                {
                  "enum": ["plain"],
                  "title": "Evaluate 'value' as plain text."
                }
              ],
              "default": "plain"
            }
          },
          "required": ["op", "header"]
        }
      }
    },
    "properties": {
      "request": { "$ref": "#/definitions/commands" },
      "response": { "$ref": "#/definitions/commands" }
    }
  }
}
